gtestï¼Œè‹±æ–‡å…¨ç§°æ˜¯Google C++ Testing Frameworkï¼Œå³è°·æ­ŒC++æµ‹è¯•æ¡†æ¶ã€‚æ˜¯ä»è°·æ­Œå†…éƒ¨è¯ç”Ÿå¹¶å—åˆ°ä¸šç•Œè¿½æ§çš„ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒå¦‚è‡ªåŠ¨å‘ç°æµ‹è¯•ã€è‡ªå®šä¹‰æ–­è¨€ã€æ­»äº¡æµ‹è¯•ã€è‡ªåŠ¨æŠ¥å‘Šç­‰è¯¸å¤šåŠŸèƒ½ã€‚
æœ¬æ–‡å°±æ¥è¯¦ç»†ä»‹ç»gtestçš„ä½¿ç”¨ã€‚
ä¸€ã€gtestæºç ä¸‹è½½

http://code.google.com/p/googletest/downloads/list

ç›®å‰æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„gtestæºä»£ç ã€‚
äºŒã€Linuxä¸‹å®‰è£…å¹¶ä½¿ç”¨gtest

1ï¼‰ä½¿ç”¨unzipå‘½ä»¤è§£å‹å®Œåï¼Œåœ¨linuxä¸Šé€šè¿‡å¦‚ä¸‹å‘½ä»¤æ‰§è¡Œç¼–è¯‘å®‰è£…


1
2
3
./configure
make
sudo make install
ä½†åœ¨æ‰§è¡Œsudo make installæ—¶ï¼Œä¼šæç¤ºç±»ä¼¼å¦‚ä¸‹é”™è¯¯ï¼š

echo â€œâ€˜make installâ€™ is dangerous and not supported. Instead, see README for how to integrate Google Test into your build system.â€ â€˜make installâ€™ is dangerous and not supported. Instead, see README for how to integrate Google Test into your build system. false

ä¹Ÿå°±æ˜¯æé†’æˆ‘ä»¬å»å®‰è£…READMEé‡Œé¢çš„æç¤ºè¿›è¡Œå®‰è£…ã€‚
äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨make
installï¼Œä¼šåœ¨æœºå™¨ä¸Šå®‰è£…ä¸€ä»½ç¼–è¯‘å¥½çš„gteståº“ï¼Œä»¥åæµ‹è¯•æ—¶åªéœ€è¦é“¾æ¥è¯¥åº“å°±å¯ä»¥äº†ï¼ˆlinuxä¸‹çš„libraryå¤§å¤šæ•°éƒ½é‡‡ç”¨è¿™ç§æ–¹å¼ï¼‰ã€‚è¿™æ ·è™½ç„¶æ–¹ä¾¿ï¼Œä½†ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šæ¯ä¸ªäººä½¿ç”¨gtestæ—¶ï¼Œå¯èƒ½éœ€è¦ä¸åŒçš„ç¼–è¯‘é€‰é¡¹ï¼Œå¦‚æœä½¿ç”¨åˆ«äººé¢„å…ˆç¼–è¯‘å¥½çš„gteståº“ï¼Œå¯èƒ½ä¼šé€ æˆæ··ä¹±ã€‚æ‰€ä»¥æ¯ä¸ªäººåœ¨ç¼–è¯‘è‡ªå·±çš„æµ‹è¯•å·¥ç¨‹æ—¶ï¼Œéœ€è¦è‡ªå·±ç¼–è¯‘è‡ªå·±éœ€è¦çš„gteståº“ã€‚å› æ­¤ç°åœ¨å¹¶ä¸æä¾›make installã€‚
READMEæ–‡æ¡£æœ‰ç‚¹é•¿ï¼Œå¦‚æœä½ è§‰å¾—éº»çƒ¦ï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹ã€‚
ä¸‰ã€google C++æµ‹è¯•æ¡†æ¶gtestä½¿ç”¨å®ä¾‹

äº‹å®ä¸Šï¼Œå°†å®‰è£…åŒ…è§£å‹åï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªsamplesçš„æ–‡ä»¶å¤¹å’Œmakeæ–‡ä»¶å¤¹ï¼Œè€Œè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œç»™å‡ºæ¥å¦‚ä½•ä½¿ç”¨gtestçš„å…·ä½“å®ä¾‹ã€‚è¿›å…¥makeæ–‡ä»¶å¤¹åï¼Œä½ èƒ½çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªMakefileæ–‡ä»¶ï¼Œè¿™ä¸ªMakefileæ–‡ä»¶å°†gtestçš„å…·ä½“ç”¨æ³•è¯´æ˜çš„æ¸…æ¸…æ¥šæ¥šã€‚Makefileå…·ä½“æ–‡ä»¶å¦‚ä¸‹ï¼š

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
# A sample Makefile for building Google Test and using it in user
# tests.  Please tweak it to suit your environment and project.  You
# may want to move it to your project's root directory.
#
# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.
 
# Please tweak the following variable definitions as needed by your
# project, except GTEST_HEADERS, which you can use in your own targets
# but shouldn't modify.
 
# Points to the root of Google Test, relative to where this file is.
# Remember to tweak this if you move this file.
GTEST_DIR = ..
 
# Where to find user code.
USER_DIR = ../samples
 
# Flags passed to the preprocessor.
# Set Google Test's header directory as a system directory, such that
# the compiler doesn't generate warnings in Google Test headers.
CPPFLAGS += -isystem $(GTEST_DIR)/include
 
# Flags passed to the C++ compiler.
CXXFLAGS += -g -Wall -Wextra -pthread
 
# All tests produced by this Makefile.  Remember to add new tests you
# created to the list.
TESTS = sample1_unittest
 
# All Google Test headers.  Usually you shouldn't change this
# definition.
GTEST_HEADERS = $(GTEST_DIR)/include/gtest/*.h \
                                                            $(GTEST_DIR)/include/gtest/internal/*.h
                                                             
# House-keeping build targets.
 
all : $(TESTS)
 
clean :
    rm -f $(TESTS) gtest.a gtest_main.a *.o
     
# Builds gtest.a and gtest_main.a.
 
# Usually you shouldn't tweak such internal variables, indicated by a
# trailing _.
GTEST_SRCS_ = $(GTEST_DIR)/src/*.cc $(GTEST_DIR)/src/*.h $(GTEST_HEADERS)
 
# For simplicity and to avoid depending on Google Test's
# implementation details, the dependencies specified below are
# conservative and not optimized.  This is fine as Google Test
# compiles fast and for ordinary users its source rarely changes.
gtest-all.o : $(GTEST_SRCS_)
    $(CXX) $(CPPFLAGS) -I$(GTEST_DIR) $(CXXFLAGS) -c \
                $(GTEST_DIR)/src/gtest-all.cc
                 
                gtest_main.o : $(GTEST_SRCS_)
                    $(CXX) $(CPPFLAGS) -I$(GTEST_DIR) $(CXXFLAGS) -c \
                                $(GTEST_DIR)/src/gtest_main.cc
                                 
                                gtest.a : gtest-all.o
                                    $(AR) $(ARFLAGS) $@ $^
                                     
                                    gtest_main.a : gtest-all.o gtest_main.o
                                        $(AR) $(ARFLAGS) $@ $^
                                         
# Builds a sample test.  A test should link with either gtest.a or
# gtest_main.a, depending on whether it defines its own main()
# function.
 
sample1.o : $(USER_DIR)/sample1.cc $(USER_DIR)/sample1.h $(GTEST_HEADERS)
    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(USER_DIR)/sample1.cc
     
    sample1_unittest.o : $(USER_DIR)/sample1_unittest.cc \
                         $(USER_DIR)/sample1.h $(GTEST_HEADERS)
                             $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(USER_DIR)/sample1_unittest.cc
                              
                             sample1_unittest : sample1.o sample1_unittest.o gtest_main.a
                                 $(CXX) $(CPPFLAGS) $(CXXFLAGS) -lpthread $^ -o $@
                                 è¿™ä¸ªMakefileæ˜¯sampliesæ–‡ä»¶å¤¹ä¸‹æºä»£ç çš„è‡ªåŠ¨åŒ–ç¼–è¯‘è„šæœ¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…æ˜¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šé¦–å…ˆåˆ‡æ¢åˆ°makeç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œmakeå‘½ä»¤ã€‚

                                 1
                                 2
                                 Code123.cc$ cd make
                                 Code123.cc$ make
                                 æ‰§è¡Œå®Œåï¼Œå°±ä¼šè‡ªåŠ¨ç¼–è¯‘å‡ºå•å…ƒæµ‹è¯•å¯æ‰§è¡Œç¨‹åºsample1_unittestã€‚
                                 gtestå®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ç¨‹åºçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

                                 1
                                 2
                                 3
                                 4
                                 5
                                 6
                                 7
                                 8
                                 9
                                 10
                                 11
                                 12
                                 13
                                 14
                                 15
                                 16
                                 17
                                 18
                                 19
                                 20
                                 21
                                 22
                                 23
                                 24
                                 25
                                 26
                                 27
                                 Code123.cc$ls
                                 gtest-all.o  gtest_main.a  gtest_main.o  Makefile  sample1.o  sample1_unittest  sample1_unittest.o
              Code123.cc$./sample1_unittest 
              Running main() from gtest_main.cc
              [==========] Running 6 tests from 2 test cases.
              [----------] Global test environment set-up.
              [----------] 3 tests from FactorialTest
              [ RUN      ] FactorialTest.Negative
              [       OK ] FactorialTest.Negative (0 ms)
    [ RUN      ] FactorialTest.Zero
    [       OK ] FactorialTest.Zero (0 ms)
    [ RUN      ] FactorialTest.Positive
    [       OK ] FactorialTest.Positive (0 ms)
    [----------] 3 tests from FactorialTest (1 ms total)
     
    [----------] 3 tests from IsPrimeTest
    [ RUN      ] IsPrimeTest.Negative
    [       OK ] IsPrimeTest.Negative (0 ms)
    [ RUN      ] IsPrimeTest.Trivial
    [       OK ] IsPrimeTest.Trivial (0 ms)
    [ RUN      ] IsPrimeTest.Positive
    [       OK ] IsPrimeTest.Positive (0 ms)
    [----------] 3 tests from IsPrimeTest (0 ms total)
     
    [----------] Global test environment tear-down
    [==========] 6 tests from 2 test cases ran. (2 ms total)
    [  PASSED  ] 6 tests.
     å››ã€å¦‚ä½•ä½¿ç”¨gtestå¯¹è‡ªå·±çš„ç¨‹åºè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Ÿ
     æœ‰äº†ç¬¬ä¸‰æ­¥çš„æ ·ä¾‹ï¼Œæˆ‘ä»¬åªéœ€è¦ä»¿ç…§samplesæ–‡ä»¶å¤¹ä¸­çš„æ ·ä¾‹ï¼Œç¼–å†™æˆ‘ä»¬è‡ªå·±çš„å•å…ƒæµ‹è¯•ç”¨ä¾‹ä¾¿å¯ã€‚(æ³¨æ„ç¬¬ä¸‰æ­¥ä¸­Makefileæ–‡ä»¶ä¸ä½ è¦æµ‹è¯•çš„æºæ–‡ä»¶æ²¡åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚æœä½ çš„æºä»£ç å­˜æ”¾ä½ç½®æœ‰å˜åŒ–ï¼Œè¯·ä¿®æ”¹å¦‚ä¸‹è¯­å¥ä¸­USER_DIRçš„å€¼ã€‚

     1
     2
# Where to find user code.
     USER_DIR = ../samples
     æ€»ç»“ï¼šä»ä¸Šé¢çš„ä½¿ç”¨å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä½¿ç”¨è°·æ­ŒC++å•å…ƒæµ‹è¯•æ¡†æ¶gtestæ—¶ï¼Œå¹¶ä¸éœ€è¦é¢„å…ˆç¼–è¯‘gtestæ¡†æ¶ï¼Œåªéœ€è¦åœ¨æµ‹è¯•ä»£ç ä¸­é€šè¿‡å¼•ç”¨gtestæºæ–‡ä»¶æ¥ä½¿ç”¨gtestè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚
